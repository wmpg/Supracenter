import numpy as np
import matplotlib.pyplot as plt

from dev.output import getO

from wmpl.PythonNRLMSISE00.nrlmsise_00_header import *
from wmpl.PythonNRLMSISE00.nrlmsise_00 import *
from wmpl.Utils.TrajConversions import jd2Date, jd2LST

from wmpl.MetSim.MetSimErosionCyTools import *
from wmpl.Utils.PecinaCeplechaFunction import *

import pyximport
pyximport.install(setup_args={'include_dirs':[np.get_include()]})

def getAtmDensity(lat, lon, height, jd):
    """ For the given heights, returns the atmospheric density from NRLMSISE-00 model. 
    
    More info: https://github.com/magnific0/nrlmsise-00/blob/master/nrlmsise-00.h
    Arguments:
        lat: [float] Latitude in radians.
        lon: [float] Longitude in radians.
        height: [float] Height in meters.
        jd: [float] Julian date.
    Return:
        [float] Atmosphere density in kg/m^3.
    """


    # Init the input array
    inp = nrlmsise_input()

    # Convert the given Julian date to datetime
    dt = jd2Date(jd, dt_obj=True)

    # Get the day of year
    doy = dt.timetuple().tm_yday

    # Get the second in day
    midnight = dt.replace(hour=0, minute=0, second=0, microsecond=0)
    sec = (dt - midnight).seconds

    # Calculate the Local sidreal time (degrees)
    lst, _ = jd2LST(jd, np.degrees(lon))


    ### INPUT PARAMETERS ###
    ##########################################################################################################
    # Set year (no effect)
    inp.year = 0

    # Day of year
    inp.doy = doy

    # Seconds in a day
    inp.sec = sec

    # Altitude in kilometers
    inp.alt = height/1000.0

    # Geodetic latitude (deg)
    inp.g_lat = np.degrees(lat)

    # Geodetic longitude (deg)
    inp.g_long = np.degrees(lon)

    # Local apparent solar time (hours)
    inp.lst = lst/15


    # f107, f107A, and ap effects are neither large nor well established below 80 km and these parameters 
    # should be set to 150., 150., and 4. respectively.

    # 81 day average of 10.7 cm radio flux (centered on DOY)
    inp.f107A = 150

    # Daily 10.7 cm radio flux for previous day
    inp.f107 = 150

    # Magnetic index (daily)
    inp.ap = 4

    ##########################################################################################################


    # Init the flags array
    flags = nrlmsise_flags()

    # Set output in kilograms and meters
    flags.switches[0] = 1

    # Set all switches to ON
    for i in range(1, 24):
        flags.switches[i] = 1

    
    # Array containing the following magnetic values:
    #   0 : daily AP
    #   1 : 3 hr AP index for current time
    #   2 : 3 hr AP index for 3 hrs before current time
    #   3 : 3 hr AP index for 6 hrs before current time
    #   4 : 3 hr AP index for 9 hrs before current time
    #   5 : Average of eight 3 hr AP indicies from 12 to 33 hrs prior to current time
    #   6 : Average of eight 3 hr AP indicies from 36 to 57 hrs prior to current time 
    aph = ap_array()

    # Set all AP indices to 100
    for i in range(7):
        aph.a[i] = 100


    # Init the output array
    # OUTPUT VARIABLES:
    #     d[0] - HE NUMBER DENSITY(CM-3)
    #     d[1] - O NUMBER DENSITY(CM-3)
    #     d[2] - N2 NUMBER DENSITY(CM-3)
    #     d[3] - O2 NUMBER DENSITY(CM-3)
    #     d[4] - AR NUMBER DENSITY(CM-3)                       
    #     d[5] - TOTAL MASS DENSITY(GM/CM3) [includes d[8] in td7d]
    #     d[6] - H NUMBER DENSITY(CM-3)
    #     d[7] - N NUMBER DENSITY(CM-3)
    #     d[8] - Anomalous oxygen NUMBER DENSITY(CM-3)
    #     t[0] - EXOSPHERIC TEMPERATURE
    #     t[1] - TEMPERATURE AT ALT
    out = nrlmsise_output()


    # Evaluate the atmosphere with the given parameters
    gtd7(inp, flags, out)


    # Get the total mass density
    atm_density = out.d[5]

    return atm_density

def atmDensityPoly(ht, dens_co):
    """ Calculates the atmospheric density in kg/m^3. 
    
    Arguments:
        ht: [double] Height in meters.
        dens_co: [ndarray] Array of 7th order poly coeffs.
    Return:
        [double] Atmosphere density at height h (kg/m^3)
    """

    return 10**(dens_co[0] 
               + dens_co[1]*(ht/1e6) 
               + dens_co[2]*(ht/1e6)**2 
               + dens_co[3]*(ht/1e6)**3 
               + dens_co[4]*(ht/1e6)**4 
               + dens_co[5]*(ht/1e6)**5
               + dens_co[6]*(ht/1e6)**6
               )

def massLoss(K, sigma, m, rho_atm, v):
    """ Mass loss differential equation, the result is giving dm/dt.
    Arguments:
        K: [double] Shape-density coefficient (m^2/kg^(2/3)).
        sigma: [double] Ablation coefficient (s^2/m^2).
        m: [double] Mass (kg).
        rho_atm: [double] Atmosphere density (kg/m^3).
        v: [double] Velocity (m/s).
    Return:
        dm/dt: [double] Mass loss in kg/s.
    """

    return -K*sigma*m**(2/3.0)*rho_atm*v**3

def deceleration(K, m, rho_atm, v):
    """ Computes the deceleration derivative.     
    Arguments:
        K: [double] Shape-density coefficient (m^2/kg^(2/3)).
        m: [double] Mass (kg).
        rho_atm: [double] Atmosphere density (kg/m^3).
        v: [double] Velocity (m/S).
    Return:
        dv/dt: [double] Deceleration.
    """

    return -K*m**(-1/3.0)*rho_atm*v**2

def curve():
	return np.array([[-2.0001,78.502,0],
	[-1.9951,78.402,0.146627919],
	[-1.9901,78.302,0.293255837],
	[-1.9851,78.202,0.439883756],
	[-1.9801,78.102,0.586511674],
	[-1.9751,78.002,0.733139593],
	[-1.9701,77.902,0.879767511],
	[-1.9651,77.802,1.02639543],
	[-1.9601,77.702,1.173023349],
	[-1.9551,77.602,1.319651267],
	[-1.9501,77.502,1.466279186],
	[-1.9451,77.402,1.612907104],
	[-1.9401,77.302,1.759535023],
	[-1.935,77.2,1.9090955],
	[-1.93,77.1,2.055723418],
	[-1.925,77,2.202351337],
	[-1.92,76.9,2.348979255],
	[-1.915,76.8,2.495607174],
	[-1.91,76.7,2.642235093],
	[-1.905,76.6,2.788863011],
	[-1.9,76.5,2.93549093],
	[-1.895,76.4,3.082118848],
	[-1.89,76.3,3.228746767],
	[-1.885,76.2,3.375374685],
	[-1.88,76.1,3.522002604],
	[-1.875,76,3.668630522],
	[-1.87,75.9,3.815258441],
	[-1.865,75.8,3.96188636],
	[-1.86,75.7,4.108514278],
	[-1.855,75.6,4.255142197],
	[-1.85,75.5,4.401770115],
	[-1.845,75.4,4.548398034],
	[-1.84,75.3,4.695025952],
	[-1.835,75.2,4.841653871],
	[-1.83,75.1,4.98828179],
	[-1.825,75,5.134909708],
	[-1.82,74.9,5.281537627],
	[-1.815,74.8,5.428165545],
	[-1.81,74.7,5.574793464],
	[-1.805,74.6,5.721421382],
	[-1.8,74.5,5.868049301],
	[-1.795,74.4,6.014677219],
	[-1.79,74.3,6.161305138],
	[-1.785,74.2,6.307933057],
	[-1.78,74.1,6.454560975],
	[-1.775,74,6.601188894],
	[-1.77,73.9,6.747816812],
	[-1.765,73.8,6.894444731],
	[-1.76,73.7,7.041072649],
	[-1.755,73.6,7.187700568],
	[-1.75,73.5,7.334328487],
	[-1.745,73.4,7.480956405],
	[-1.74,73.3,7.627584324],
	[-1.735,73.2,7.774212242],
	[-1.73,73.1,7.920840161],
	[-1.725,73,8.067468079],
	[-1.72,72.9,8.214095998],
	[-1.715,72.8,8.360723917],
	[-1.71,72.7,8.507351835],
	[-1.705,72.6,8.653979754],
	[-1.7,72.5,8.800607672],
	[-1.695,72.4,8.947235591],
	[-1.69,72.3,9.093863509],
	[-1.685,72.2,9.240491428],
	[-1.68,72.1,9.387119346],
	[-1.675,72,9.533747265],
	[-1.67,71.9,9.680375184],
	[-1.665,71.8,9.827003102],
	[-1.66,71.7,9.973631021],
	[-1.655,71.6,10.12025894],
	[-1.65,71.5,10.26688686],
	[-1.645,71.4,10.41351478],
	[-1.64,71.3,10.56014269],
	[-1.635,71.2,10.70677061],
	[-1.63,71.1,10.85339853],
	[-1.625,71,11.00002645],
	[-1.62,70.9,11.14665437],
	[-1.615,70.8,11.29328229],
	[-1.61,70.7,11.43991021],
	[-1.605,70.6,11.58653812],
	[-1.6,70.5,11.73316604],
	[-1.595,70.4,11.87979396],
	[-1.59,70.3,12.02642188],
	[-1.585,70.2,12.1730498],
	[-1.58,70.1,12.31967772],
	[-1.575,70,12.46630564],
	[-1.57,69.9,12.61293355],
	[-1.565,69.8,12.75956147],
	[-1.56,69.7,12.90618939],
	[-1.555,69.6,13.05281731],
	[-1.55,69.5,13.19944523],
	[-1.545,69.4,13.34607315],
	[-1.54,69.3,13.49270107],
	[-1.535,69.2,13.63932898],
	[-1.53,69.1,13.7859569],
	[-1.525,69,13.93258482],
	[-1.52,68.9,14.07921274],
	[-1.515,68.8,14.22584066],
	[-1.51,68.7,14.37246858],
	[-1.505,68.6,14.5190965],
	[-1.5,68.5,14.66572441],
	[-1.495,68.4,14.81235233],
	[-1.49,68.3,14.95898025],
	[-1.485,68.2,15.10560817],
	[-1.48,68.1,15.25223609],
	[-1.475,68,15.39886401],
	[-1.47,67.9,15.54549193],
	[-1.465,67.8,15.69211984],
	[-1.46,67.7,15.83874776],
	[-1.455,67.6,15.98537568],
	[-1.45,67.5,16.1320036],
	[-1.445,67.4,16.27863152],
	[-1.44,67.3,16.42525944],
	[-1.435,67.2,16.57188736],
	[-1.43,67.1,16.71851527],
	[-1.425,67,16.86514319],
	[-1.42,66.9,17.01177111],
	[-1.415,66.8,17.15839903],
	[-1.41,66.7,17.30502695],
	[-1.405,66.6,17.45165487],
	[-1.4,66.5,17.59828279],
	[-1.395,66.4,17.7449107],
	[-1.39,66.3,17.89153862],
	[-1.385,66.2,18.03816654],
	[-1.38,66.1,18.18479446],
	[-1.375,66,18.33142238],
	[-1.37,65.9,18.4780503],
	[-1.365,65.8,18.62467822],
	[-1.36,65.7,18.77130613],
	[-1.355,65.6,18.91793405],
	[-1.35,65.5,19.06456197],
	[-1.345,65.4,19.21118989],
	[-1.34,65.3,19.35781781],
	[-1.335,65.2,19.50444573],
	[-1.33,65.1,19.65107365],
	[-1.325,65,19.79770156],
	[-1.32,64.9,19.94432948],
	[-1.315,64.8,20.0909574],
	[-1.31,64.7,20.23758532],
	[-1.305,64.6,20.38421324],
	[-1.3,64.5,20.53084116],
	[-1.295,64.4,20.67746908],
	[-1.29,64.3,20.82409699],
	[-1.285,64.2,20.97072491],
	[-1.28,64.1,21.11735283],
	[-1.275,64,21.26398075],
	[-1.27,63.9,21.41060867],
	[-1.265,63.8,21.55723659],
	[-1.26,63.7,21.70386451],
	[-1.255,63.6,21.85049242],
	[-1.25,63.5,21.99712034],
	[-1.245,63.4,22.14374826],
	[-1.24,63.3,22.29037618],
	[-1.235,63.2,22.4370041],
	[-1.23,63.1,22.58363202],
	[-1.225,63,22.73025994],
	[-1.22,62.9,22.87688785],
	[-1.215,62.8,23.02351577],
	[-1.21,62.7,23.17014369],
	[-1.205,62.6,23.31677161],
	[-1.2,62.5,23.46339953],
	[-1.195,62.4,23.61002745],
	[-1.19,62.3,23.75665537],
	[-1.185,62.2,23.90328328],
	[-1.18,62.1,24.0499112],
	[-1.175,62,24.19653912],
	[-1.17,61.9,24.34316704],
	[-1.165,61.8,24.48979496],
	[-1.16,61.7,24.63642288],
	[-1.155,61.6,24.7830508],
	[-1.15,61.5,24.92967871],
	[-1.145,61.4,25.07630663],
	[-1.14,61.3,25.22293455],
	[-1.135,61.2,25.36956247],
	[-1.13,61.1,25.51619039],
	[-1.125,61,25.66281831],
	[-1.12,60.9,25.80944623],
	[-1.115,60.8,25.95607414],
	[-1.11,60.7,26.10270206],
	[-1.105,60.6,26.24932998],
	[-1.1,60.5,26.3959579],
	[-1.095,60.4,26.54258582],
	[-1.09,60.3,26.68921374],
	[-1.085,60.2,26.83584166],
	[-1.08,60.1,26.98246957],
	[-1.075,60,27.12909749],
	[-1.07,59.9,27.27572541],
	[-1.065,59.8,27.42235333],
	[-1.06,59.7,27.56898125],
	[-1.055,59.6,27.71560917],
	[-1.05,59.5,27.86223709],
	[-1.045,59.4,28.008865],
	[-1.04,59.3,28.15549292],
	[-1.035,59.2,28.30212084],
	[-1.03,59.1,28.44874876],
	[-1.025,59,28.59537668],
	[-1.02,58.9,28.7420046],
	[-1.015,58.8,28.88863252],
	[-1.01,58.7,29.03526043],
	[-1.005,58.6,29.18188835],
	[-1,58.5,29.32851627],
	[-0.995,58.4,29.47514419],
	[-0.99,58.3,29.62177211],
	[-0.985,58.2,29.76840003],
	[-0.98,58.1,29.91502795],
	[-0.975,58,30.06165586],
	[-0.97,57.9,30.20828378],
	[-0.965,57.8,30.3549117],
	[-0.96,57.7,30.50153962],
	[-0.955,57.6,30.64816754],
	[-0.95,57.5,30.79479546],
	[-0.945,57.4,30.94142338],
	[-0.94,57.3,31.08805129],
	[-0.935,57.2,31.23467921],
	[-0.93,57.1,31.38130713],
	[-0.925,57,31.52793505],
	[-0.92,56.9,31.67456297],
	[-0.915,56.8,31.82119089],
	[-0.91,56.7,31.96781881],
	[-0.905,56.6,32.11444672],
	[-0.9,56.5,32.26107464],
	[-0.895,56.4,32.40770256],
	[-0.89,56.3,32.55433048],
	[-0.885,56.2,32.7009584],
	[-0.88,56.1,32.84758632],
	[-0.875,56,32.99421424],
	[-0.87,55.9,33.14084215],
	[-0.865,55.8,33.28747007],
	[-0.86,55.7,33.43409799],
	[-0.855,55.6,33.58072591],
	[-0.85,55.5,33.72735383],
	[-0.845,55.4,33.87398175],
	[-0.84,55.3,34.02060967],
	[-0.835,55.2,34.16723758],
	[-0.83,55.1,34.3138655],
	[-0.825,55,34.46049342],
	[-0.82,54.9,34.60712134],
	[-0.815,54.8,34.75374926],
	[-0.81,54.7,34.90037718],
	[-0.805,54.6,35.0470051],
	[-0.8,54.5,35.19363301],
	[-0.795,54.4,35.34026093],
	[-0.79,54.3,35.48688885],
	[-0.785,54.2,35.63351677],
	[-0.78,54.1,35.78014469],
	[-0.7749,53.998,35.92970516],
	[-0.7699,53.898,36.07633308],
	[-0.7649,53.798,36.222961],
	[-0.7599,53.698,36.36958892],
	[-0.7549,53.598,36.51621684],
	[-0.7499,53.498,36.66284476],
	[-0.7449,53.398,36.80947268],
	[-0.7399,53.298,36.95610059],
	[-0.7349,53.198,37.10272851],
	[-0.7299,53.098,37.24935643],
	[-0.7249,52.998,37.39598435],
	[-0.7199,52.898,37.54261227],
	[-0.7149,52.798,37.68924019],
	[-0.71,52.7,37.83293555],
	[-0.705,52.6,37.97956347],
	[-0.7,52.5,38.12619139],
	[-0.695,52.4,38.2728193],
	[-0.69,52.3,38.41944722],
	[-0.685,52.2,38.56607514],
	[-0.68,52.1,38.71270306],
	[-0.675,52,38.85933098],
	[-0.67,51.9,39.0059589],
	[-0.665,51.8,39.15258681],
	[-0.66,51.7,39.29921473],
	[-0.655,51.6,39.44584265],
	[-0.65,51.5,39.59247057],
	[-0.645,51.4,39.73909849],
	[-0.64,51.3,39.88572641],
	[-0.635,51.2,40.03235433],
	[-0.63,51.1,40.17898224],
	[-0.625,51,40.32561016],
	[-0.62,50.9,40.47223808],
	[-0.615,50.8,40.618866],
	[-0.61,50.7,40.76549392],
	[-0.605,50.6,40.91212184],
	[-0.6,50.5,41.05874976],
	[-0.595,50.4,41.20537767],
	[-0.59,50.3,41.35200559],
	[-0.585,50.2,41.49863351],
	[-0.58,50.1,41.64526143],
	[-0.575,50,41.79188935],
	[-0.57,49.9,41.93851727],
	[-0.565,49.8,42.08514519],
	[-0.56,49.7,42.2317731],
	[-0.555,49.6,42.37840102],
	[-0.55,49.5,42.52502894],
	[-0.545,49.4,42.67165686],
	[-0.54,49.3,42.81828478],
	[-0.535,49.2,42.9649127],
	[-0.53,49.1,43.11154062],
	[-0.525,49,43.25816853],
	[-0.52,48.9,43.40479645],
	[-0.515,48.8,43.55142437],
	[-0.51,48.7,43.69805229],
	[-0.505,48.6,43.84468021],
	[-0.5,48.5,43.99130813],
	[-0.495,48.4,44.13793605],
	[-0.49,48.3,44.28456396],
	[-0.485,48.2,44.43119188],
	[-0.48,48.1,44.5778198],
	[-0.475,48,44.72444772],
	[-0.47,47.9,44.87107564],
	[-0.465,47.8,45.01770356],
	[-0.46,47.7,45.16433148],
	[-0.455,47.6,45.31095939],
	[-0.45,47.5,45.45758731],
	[-0.445,47.4,45.60421523],
	[-0.44,47.3,45.75084315],
	[-0.435,47.2,45.89747107],
	[-0.43,47.1,46.04409899],
	[-0.425,47,46.19072691],
	[-0.42,46.9,46.33735482],
	[-0.415,46.8,46.48398274],
	[-0.41,46.7,46.63061066],
	[-0.405,46.6,46.77723858],
	[-0.4,46.5,46.9238665],
	[-0.395,46.4,47.07049442],
	[-0.39,46.3,47.21712234],
	[-0.385,46.2,47.36375025],
	[-0.38,46.1,47.51037817],
	[-0.375,46,47.65700609],
	[-0.37,45.9,47.80363401],
	[-0.365,45.8,47.95026193],
	[-0.36,45.7,48.09688985],
	[-0.355,45.6,48.24351777],
	[-0.35,45.5,48.39014568],
	[-0.345,45.4,48.5367736],
	[-0.34,45.3,48.68340152],
	[-0.335,45.2,48.83002944],
	[-0.33,45.1,48.97665736],
	[-0.325,45,49.12328528],
	[-0.32,44.9,49.2699132],
	[-0.315,44.8,49.41654111],
	[-0.31,44.7,49.56316903],
	[-0.305,44.6,49.70979695],
	[-0.3,44.5,49.85642487],
	[-0.295,44.4,50.00305279],
	[-0.29,44.3,50.14968071],
	[-0.285,44.2,50.29630863],
	[-0.28,44.1,50.44293654],
	[-0.275,44,50.58956446],
	[-0.27,43.9,50.73619238],
	[-0.265,43.8,50.8828203],
	[-0.26,43.7,51.02944822],
	[-0.255,43.6,51.17607614],
	[-0.25,43.5,51.32270406],
	[-0.245,43.4,51.46933197],
	[-0.24,43.3,51.61595989],
	[-0.235,43.2,51.76258781],
	[-0.23,43.1,51.90921573],
	[-0.225,43,52.05584365],
	[-0.22,42.9,52.20247157],
	[-0.215,42.8,52.34909949],
	[-0.21,42.7,52.4957274],
	[-0.205,42.6,52.64235532],
	[-0.2,42.5,52.78898324],
	[-0.195,42.4,52.93561116],
	[-0.19,42.3,53.08223908],
	[-0.185,42.2,53.228867],
	[-0.18,42.1,53.37549492],
	[-0.175,42,53.52212283],
	[-0.17,41.9,53.66875075],
	[-0.165,41.8,53.81537867],
	[-0.16,41.7,53.96200659],
	[-0.155,41.6,54.10863451],
	[-0.15,41.5,54.25526243],
	[-0.145,41.4,54.40189035],
	[-0.14,41.3,54.54851826],
	[-0.135,41.2,54.69514618],
	[-0.13,41.1,54.8417741],
	[-0.125,41,54.98840202],
	[-0.12,40.9,55.13502994],
	[-0.115,40.8,55.28165786],
	[-0.11,40.7,55.42828578],
	[-0.105,40.6,55.57491369],
	[-0.1,40.5,55.72154161],
	[-0.095,40.4,55.86816953],
	[-0.09,40.3,56.01479745],
	[-0.085,40.2,56.16142537],
	[-0.08,40.1,56.30805329],
	[-0.075,40,56.45468121],
	[-0.07,39.9,56.60130912],
	[-0.065,39.8,56.74793704],
	[-0.06,39.7,56.89456496],
	[-0.055,39.6,57.04119288],
	[-0.05,39.5,57.1878208],
	[-0.045,39.4,57.33444872],
	[-0.04,39.3,57.48107664],
	[-0.035,39.2,57.62770455],
	[-0.03,39.1,57.77433247],
	[-0.025,39,57.92096039],
	[-0.02,38.9,58.06758831],
	[-0.015,38.8,58.21421623],
	[-0.01,38.7,58.36084415],
	[-0.005,38.6,58.50747207],
	[0,38.5,58.65409998],
	[0.005,38.4,58.8007279],
	[0.01,38.3,58.94735582],
	[0.015,38.2,59.09398374],
	[0.02,38.1,59.24061166],
	[0.025,38,59.38723958],
	[0.03,37.9,59.5338675],
	[0.035,37.8,59.68049541],
	[0.04,37.7,59.82712333],
	[0.045,37.6,59.97375125],
	[0.05,37.5,60.12037917],
	[0.055,37.4,60.26700709],
	[0.06,37.3,60.41363501],
	[0.065,37.2,60.56026293],
	[0.07,37.1,60.70689084],
	[0.075,37,60.85351876],
	[0.08,36.9,61.00014668],
	[0.085,36.8,61.1467746],
	[0.09,36.7,61.29340252],
	[0.095,36.6,61.44003044],
	[0.1,36.5,61.58665836],
	[0.105,36.4,61.73328627],
	[0.11,36.3,61.87991419],
	[0.115,36.2,62.02654211],
	[0.12,36.1,62.17317003],
	[0.125,36,62.31979795],
	[0.13,35.9,62.46642587],
	[0.135,35.8,62.61305379],
	[0.14,35.7,62.7596817],
	[0.145,35.6,62.90630962],
	[0.15,35.5,63.05293754],
	[0.155,35.4,63.19956546],
	[0.16,35.3,63.34619338],
	[0.165,35.2,63.4928213],
	[0.17,35.1,63.63944922],
	[0.175,35,63.78607713],
	[0.18,34.9,63.93270505],
	[0.185,34.8,64.07933297],
	[0.19,34.7,64.22596089],
	[0.195,34.6,64.37258881],
	[0.2,34.5,64.51921673],
	[0.205,34.4,64.66584465],
	[0.21,34.3,64.81247256],
	[0.215,34.2,64.95910048],
	[0.22,34.1,65.1057284],
	[0.225,34,65.25235632],
	[0.23,33.9,65.39898424],
	[0.235,33.8,65.54561216],
	[0.24,33.7,65.69224008],
	[0.245,33.6,65.83886799],
	[0.25,33.5,65.98549591],
	[0.255,33.4,66.13212383],
	[0.26,33.3,66.27875175],
	[0.265,33.2,66.42537967],
	[0.27,33.1,66.57200759],
	[0.275,33,66.7186355],
	[0.28,32.9,66.86526342],
	[0.285,32.8,67.01189134],
	[0.29,32.7,67.15851926],
	[0.295,32.6,67.30514718],
	[0.3,32.5,67.4517751],
	[0.305,32.4,67.59840302],
	[0.31,32.3,67.74503093],
	[0.315,32.2,67.89165885],
	[0.32,32.1,68.03828677],
	[0.325,32,68.18491469],
	[0.33,31.9,68.33154261],
	[0.335,31.8,68.47817053],
	[0.34,31.7,68.62479845],
	[0.345,31.6,68.77142636],
	[0.35,31.5,68.91805428],
	[0.355,31.4,69.0646822],
	[0.36,31.3,69.21131012],
	[0.365,31.2,69.35793804],
	[0.37,31.1,69.50456596],
	[0.375,31,69.65119388],
	[0.38,30.9,69.79782179],
	[0.385,30.8,69.94444971],
	[0.39,30.7,70.09107763],
	[0.395,30.6,70.23770555],
	[0.4,30.5,70.38433347],
	[0.405,30.4,70.53096139],
	[0.41,30.3,70.67758931],
	[0.415,30.2,70.82421722],
	[0.42,30.1,70.97084514],
	[0.425,30,71.11747306],
	[0.43,29.9,71.26410098],
	[0.435,29.8,71.4107289],
	[0.44,29.7,71.55735682],
	[0.445,29.6,71.70398474],
	[0.45,29.5,71.85061265],
	[0.455,29.4,71.99724057],
	[0.46,29.3,72.14386849],
	[0.465,29.2,72.29049641],
	[0.47,29.1,72.43712433],
	[0.475,29,72.58375225],
	[0.48,28.9,72.73038017],
	[0.485,28.8,72.87700808],
	[0.49,28.7,73.023636],
	[0.495,28.6,73.17026392],
	[0.5,28.5,73.31689184]])

dens_co = np.array([-9.02726494,
                        0.108986696,
                        -0.0005189,
                        -2.0646e-5,
                        1.93881e-7,
                        -4.7231e-10, 0])
v_init = 27760
mass_init = 4500
sigma = 0.01/1e6
K = 0.7/(2500)**(2/3)


height_list = np.linspace(85500, 0, 4000)

v = v_init
m = mass_init

t = luminousEfficiency(3, 1, v_init, mass_init)

tau_list = []
tau_list.append([85500, t*100, v_init, mass_init, 1000])

dh = height_list[1] - height_list[0]
lat = np.radians(45.7024)
lon = np.radians(26.9007)
jd = 2457029.54582
sudden_loss = 850
import random
counter = 0
for h in height_list:

	dens = getAtmDensity(lat, lon, h, jd)

	dv = deceleration(K, m, dens, v)
	dm = massLoss(K, sigma, m, dens, v)


	dl = dh/(np.cos(np.radians(47)))
	dt = np.abs(dl/v)


	vel = v + dv*dt
	mass = m + dm*dt

	if np.abs(h - 53500) <= 10:
		mass -= 30

	if 42000 <= h <= 48000:

		mass -= 11.39


	if np.abs(h - 44700) <= 10:
		print("1")
		mass -= 300
	
	if np.abs(h - 43200) <= 10:
		print("2")
		mass -= 500

	if np.abs(h - 42000) <= 10:
		print("3")
		mass -= 100

	if np.abs(h - 41000) <= 10:
		print("4")
		mass -= 10

	if h <= 42000:
		mass -= 1.1

	t = luminousEfficiency(3, 1, vel, mass)

	dyn = dens*vel**2


	tau_list.append([h, t*100, vel, mass, dyn])

	v = vel
	m = mass

tau_list = np.array(tau_list)

data = np.array([[0.009858000137488755, 4429.609300890416],
[0.8667387208628936, 4195.558528162144],
[0.8792236851030195, 3763.90373001826],
[1.389495494373136, 3112.6032895675453],
[1.4095105244410164, 2309.1798560776215],
[1.6496480740980206, 2247.345998883871],
[1.6734104799051615, 1579.16783936594],
[1.74677120801992, 644.8077600240982],
[1.9867199185099855, 610.7375420334304],
[2.1036881784318844, 180.0539902913994],
[2.3251963220650094, 165.97370651171852],
[2.7213387683753085, 34.383159035209836],
[3.007882518043102, 3.6137389607345267],
[3.051209653167377, 0.9557705280602697],
[3.1397452344877848, 0.19799768745384114]])

ho, mo, vo = getO()

to_list = []
dyn_list = []
for ii in range(len(ho)):
	dens = getAtmDensity(lat, lon, ho[ii], jd)
	t = luminousEfficiency(3, 1, vo[ii], mo[ii])
	dyn = dens*vo[ii]**2

	to_list.append(t)
	dyn_list.append(dyn)
	print(ho[ii], dyn/1e6)

new_plots = np.array([[101912.0595578985, 4999.9660015101645, 27759.987698420442],
[101816.28818611383, 4999.965486559112, 27759.987439805253],
[101720.51465989438, 4999.964962922354, 27759.9871767204],
[101624.73897926809, 4999.96443044635, 27759.98690908686],
[101528.96114426314, 4999.9638889747985, 27759.9866368242],
[101433.18115490804, 4999.9633383485925, 27759.986359850536],
[101337.3990112316, 4999.9627784057675, 27759.98607808252],
[101241.61471326285, 4999.962208981452, 27759.985791435294],
[101145.82826103122, 4999.961629907813, 27759.9854998225],
[101050.03965456637, 4999.9610410140085, 27759.9852031562],
[100954.2488938983, 4999.960442126128, 27759.98490134691],
[100858.45597905734, 4999.959833067143, 27759.98459430352],
[100762.66091007413, 4999.959213656848, 27759.9842819333],
[100666.86368697963, 4999.9585837118075, 27759.983964141826],
[100571.06430980515, 4999.957943045296, 27759.983640833023],
[100475.26277858234, 4999.957291467241, 27759.98331190907],
[100379.45909334318, 4999.956628784164, 27759.982977270392],
[100283.65325412001, 4999.955954799121, 27759.982636815635],
[100187.84526094556, 4999.95526931164, 27759.982290441632],
[100092.03511385286, 4999.954572117658, 27759.98193804337],
[99996.22281287538, 4999.95386300946, 27759.981579513948],
[99900.40835804692, 4999.953141775613, 27759.98121474455],
[99804.59174940169, 4999.952408200902, 27759.980843624424],
[99708.77298697429, 4999.95166206626, 27759.980466040834],
[99612.95207079971, 4999.950903148705, 27759.980081879017],
[99517.12900091337, 4999.950131221269, 27759.979691022174],
[99421.30377735107, 4999.9493460529275, 27759.979293351415],
[99325.47640014905, 4999.948547408529, 27759.97888874571],
[99229.646869344, 4999.947735048721, 27759.9784770819],
[99133.81518497299, 4999.946908729882, 27759.978058234585],
[99037.98134707358, 4999.946068204039, 27759.977632076163],
[98942.14535568377, 4999.945213218797, 27759.97719847674],
[98846.30721084202, 4999.944343517261, 27759.97675730411],
[98750.46691258725, 4999.943458837954, 27759.976308423706],
[98654.62446095886, 4999.942558914742, 27759.97585169856],
[98558.77985599675, 4999.941643476751, 27759.97538698927],
[98462.9330977413, 4999.940712248282, 27759.974914153958],
[98367.0841862334, 4999.939764948731, 27759.974433048214],
[98271.23312151444, 4999.938801292502, 27759.973943525052],
[98175.37990362634, 4999.93782098892, 27759.973445434884],
[98079.52453261154, 4999.936823742144, 27759.972938625455],
[97983.66700851303, 4999.9358092510765, 27759.972422941813],
[97887.80733137434, 4999.934777209272, 27759.971898226242],
[97791.94550123956, 4999.9337273048495, 27759.97136431824],
[97696.08151815335, 4999.932659220391, 27759.970821054452],
[97600.21538216097, 4999.9315726328505, 27759.970268268615],
[97504.34709330821, 4999.930467213458, 27759.96970579154],
[97408.47665164154, 4999.929342627617, 27759.96913345102],
[97312.60405720797, 4999.92819853481, 27759.96855107182],
[97216.72931005515, 4999.927034588489, 27759.96795847558],
[97120.85241023138, 4999.92585043598, 27759.967355480807],
[97024.9733577856, 4999.924645718373, 27759.966741902786],
[96929.09215276736, 4999.923420070417, 27759.96611755354],
[96833.20879522694, 4999.922173120411, 27759.965482241776],
[96737.32328521526, 4999.920904490094, 27759.964835772822],
[96641.43562278393, 4999.919613794534, 27759.96417794858],
[96545.54580798527, 4999.918300642013, 27759.96350856744],
[96449.6538408723, 4999.9169646339105, 27759.962827424264],
[96353.75972149879, 4999.91560536459, 27759.962134310284],
[96257.86344991923, 4999.914222421276, 27759.96142901307],
[96161.96502618886, 4999.912815383934, 27759.96071131645],
[96066.0644503637, 4999.911383825148, 27759.95998100045],
[95970.16172250055, 4999.9099273099955, 27759.959237841245],
[95874.25684265698, 4999.908445395921, 27759.95848161106],
[95778.34981089138, 4999.906937632606, 27759.957712078143],
[95682.44062726296, 4999.905403561838, 27759.956929006683],
[95586.52929183176, 4999.90384271738, 27759.956132156713],
[95490.61580465866, 4999.9022546248325, 27759.955321284087],
[95394.70016580545, 4999.900638801498, 27759.95449614038],
[95298.78237533473, 4999.89899475624, 27759.953656472833],
[95202.86243331006, 4999.897321989348, 27759.952802024254],
[95106.94033979585, 4999.895619992383, 27759.951932532982],
[95011.01609485749, 4999.8938882480425, 27759.951047732775],
[94915.08969856128, 4999.892126230005, 27759.95014735276],
[94819.16115097448, 4999.890333402784, 27759.949231117338],
[94723.23045216534, 4999.888509221573, 27759.948298746127],
[94627.29760220309, 4999.8866531320955, 27759.947349953854],
[94531.36260115798, 4999.884764570439, 27759.9463844503],
[94435.42544910125, 4999.882842962904, 27759.9454019402],
[94339.48614610525, 4999.880887725836, 27759.94440212317],
[94243.54469224335, 4999.878898265467, 27759.943384693604],
[94147.60108759, 4999.8768739777415, 27759.94234934064],
[94051.65533222075, 4999.874814248153, 27759.94129574799],
[93955.70742621229, 4999.872718451567, 27759.940223593927],
[93859.75736964244, 4999.870585952053, 27759.939132551153],
[93763.80516259016, 4999.868416102701, 27759.938022286722],
[93667.8508051356, 4999.866208245446, 27759.93689246195],
[93571.89429736014, 4999.863961710881, 27759.93574273231],
[93475.93563934631, 4999.861675818078, 27759.934572747352],
[93379.97483117794, 4999.859349874395, 27759.933382150582],
[93284.0118729401, 4999.8569831752875, 27759.932170579395],
[93188.04676471914, 4999.854575004115, 27759.930937664947],
[93092.0795066027, 4999.852124631944, 27759.929683032078],
[92996.1100986798, 4999.849631317352, 27759.928406299194],
[92900.13854104074, 4999.847094306219, 27759.92710707816],
[92804.16483377725, 4999.844512831531, 27759.925784974213],
[92708.18897698242, 4999.841886113163, 27759.924439585833],
[92612.21097075079, 4999.839213357677, 27759.923070504654],
[92516.23081517832, 4999.836493758101, 27759.921677315335],
[92420.24851036245, 4999.833726493716, 27759.92025959547],
[92324.26405640211, 4999.8309107298355, 27759.918816915455],
[92228.27745339775, 4999.82804561758, 27759.917348838375],
[92132.28870145137, 4999.825130293652, 27759.91585491991],
[92036.29780066655, 4999.82216388011, 27759.914334708188],
[91940.30475114845, 4999.819145484127, 27759.912787743677],
[91844.30955300386, 4999.816074197764, 27759.911213559062],
[91748.31220634123, 4999.812949097723, 27759.909611679133],
[91652.31271127069, 4999.809769245108, 27759.907981620643],
[91556.31106790407, 4999.806533685181, 27759.906322892184],
[91460.30727635496, 4999.803241447106, 27759.904634994076],
[91364.30133673869, 4999.7998915437, 27759.902917418207],
[91268.2932491724, 4999.796482971176, 27759.901169647932],
[91172.28301377509, 4999.793014708885, 27759.899391157916],
[91076.27063066754, 4999.789485719046, 27759.89758141401],
[90980.2560999725, 4999.785894946486, 27759.895739873107],
[90884.23942181458, 4999.782241318365, 27759.893865983006],
[90788.22059632039, 4999.778523743901, 27759.891959182274],
[90692.1996236185, 4999.7747411140945, 27759.89001890009],
[90596.1765038395, 4999.770892301444, 27759.888044556115],
[90500.15123711604, 4999.766976159662, 27759.886035560332],
[90404.12382358285, 4999.762991523381, 27759.88399131292],
[90308.0942633768, 4999.758937207867, 27759.881911204062],
[90212.0625566369, 4999.754812008717, 27759.87979461383],
[90116.02870350434, 4999.750614701556, 27759.87764091201],
[90019.99270412259, 4999.746344041737, 27759.875449457948],
[89923.95455863731, 4999.741998764028, 27759.873219600402],
[89827.91426719654, 4999.737577582299, 27759.870950677356],
[89731.8718299506, 4999.7330791892055, 27759.86864201588],
[89635.82724705224, 4999.728502255864, 27759.866292931958],
[89539.78051865658, 4999.72384543153, 27759.863902730314],
[89443.73164492124, 4999.719107343263, 27759.86147070424],
[89347.68062600632, 4999.714286595598, 27759.858996135437],
[89251.62746207447, 4999.709381770202, 27759.85647829383],
[89155.57215329091, 4999.704391425532, 27759.853916437394],
[89059.5146998235, 4999.69931409649, 27759.851309811977],
[88963.45510184276, 4999.694148294068, 27759.848657651102],
[88867.39335952191, 4999.688892504995, 27759.84595917583],
[88771.32947303695, 4999.683545191373, 27759.843213594508],
[88675.26344256666, 4999.678104790314, 27759.840420102635],
[88579.19526829268, 4999.67256971357, 27759.837577882645],
[88483.1249503995, 4999.666938347157, 27759.83468610372],
[88387.05248907462, 4999.661209050978, 27759.831743921604],
[88290.97788450847, 4999.655380158439, 27759.828750478384],
[88194.90113689452, 4999.649449976059, 27759.82570490231],
[88098.82224642935, 4999.64341678308, 27759.822606307585],
[88002.74121331265, 4999.637278831066, 27759.819453794153],
[87906.6580377473, 4999.631034343502, 27759.816246447506],
[87810.57271993943, 4999.624681515384, 27759.812983338466],
[87714.48526009843, 4999.61821851281, 27759.809663522963],
[87618.39565843703, 4999.611643472563, 27759.806286041847],
[87522.30391517137, 4999.604954501683, 27759.802849920638],
[87426.21003052105, 4999.598149677047, 27759.79935416932],
[87330.11400470912, 4999.591227044932, 27759.79579778213],
[87234.01583796223, 4999.584184620576, 27759.792179737313],
[87137.91553051063, 4999.577020387742, 27759.7884989969],
[87041.81308258824, 4999.569732298264, 27759.78475450649],
[86945.70849443272, 4999.562318271598, 27759.780945194994],
[86849.6017662855, 4999.554776194362, 27759.77706997441],
[86753.49289839188, 4999.547103919873, 27759.773127739594],
[86657.38189100105, 4999.539299267679, 27759.76911736801],
[86561.26874436616, 4999.531360023085, 27759.765037719477],
[86465.15345874442, 4999.523283936673, 27759.760887635926],
[86369.03603439713, 4999.515068723818, 27759.756665941164],
[86272.91647158974, 4999.5067120642, 27759.75237144061],
[86176.7947705919, 4999.498211601303, 27759.74800292103],
[86080.67093167763, 4999.489564941921, 27759.743559150305],
[85984.54495512522, 4999.480769655645, 27759.739038877135],
[85888.41684121743, 4999.471823274358, 27759.734440830813],
[85792.28659024152, 4999.46272329171, 27759.729763720923],
[85696.15420248928, 4999.453467162601, 27759.725006237102],
[85600.01967825716, 4999.444052302648, 27759.720167048734],
[85503.88301784631, 4999.434476087654, 27759.715244804705],
[85407.74422156265, 4999.424735853066, 27759.710238133102],
[85311.60328971696, 4999.414828893429, 27759.705145640943],
[85215.46022262497, 4999.404752461837, 27759.699965913886],
[85119.31502060736, 4999.394503769371, 27759.694697515963],
[85023.16768398992, 4999.384079984541, 27759.689338989247],
[84927.01821310358, 4999.373478232714, 27759.683888853593],
[84830.86660828454, 4999.362695595539, 27759.678345606346],
[84734.71286987429, 4999.351729110369, 27759.672707722],
[84638.55699821969, 4999.340575769673, 27759.666973651936],
[84542.39899367311, 4999.329232520442, 27759.66114182411],
[84446.23885659248, 4999.317696263594, 27759.655210642715],
[84350.07658734135, 4999.305963853368, 27759.649178487918],
[84253.91218628902, 4999.294032096712, 27759.64304371549],
[84157.74565381059, 4999.281897752669, 27759.636804656526],
[84061.57699028708, 4999.269557531754, 27759.630459617118],
[83965.40619610548, 4999.257008095326, 27759.624006878013],
[83869.23327165887, 4999.244246054953, 27759.61744469432],
[83773.0582173465, 4999.231267971771, 27759.610771295123],
[83676.88103357387, 4999.218070355839, 27759.60398488321],
[83580.70172075286, 4999.204649665485, 27759.597083634693],
[83484.52027930177, 4999.191002306647, 27759.59006569868],
[83388.33670964547, 4999.177124632208, 27759.58292919693],
[83292.15101221547, 4999.163012941325, 27759.575672223524],
[83195.96318745002, 4999.148663478754, 27759.56829284448],
[83099.77323579419, 4999.134072434163, 27759.560789097435],
[83003.5811577, 4999.119235941441, 27759.553158991264],
[82907.38695362651, 4999.1041500780075, 27759.54540050573],
[82811.19062403993, 4999.088810864107, 27759.53751159112],
[82714.99216941372, 4999.073214262098, 27759.529490167883],
[82618.79159022868, 4999.057356175745, 27759.521334126246],
[82522.58888697308, 4999.04123244949, 27759.513041325867],
[82426.38406014277, 4999.024838867731, 27759.50460959543],
[82330.17711024123, 4999.008171154085, 27759.496036732282],
[82233.9680377798, 4998.99122497065, 27759.48732050205],
[82137.75684327768, 4998.973995917258, 27759.47845863825],
[82041.54352726207, 4998.956479530724, 27759.4694488419],
[81945.32809026833, 4998.938671284084, 27759.460288781123],
[81849.11053284006, 4998.920566585835, 27759.45097609077],
[81752.89085552921, 4998.90216077916, 27759.441508372],
[81656.66905889622, 4998.883449141152, 27759.43188319187],
[81560.44514351014, 4998.864426882027, 27759.42209808296],
[81464.21910994872, 4998.845089144341, 27759.412150542943],
[81367.9909587986, 4998.825431002185, 27759.402038034168],
[81271.76069065536, 4998.805447460388, 27759.39175798327],
[81175.52830612367, 4998.785133453705, 27759.38130778072],
[81079.29380581748, 4998.7644838460055, 27759.37068478042],
[80983.05719036004, 4998.743493429446, 27759.359886299273],
[80886.81846038411, 4998.722156923647, 27759.34890961676],
[80790.57761653207, 4998.700468974856, 27759.337751974497],
[80694.33465945606, 4998.67842415511, 27759.326410575806],
[80598.08958981809, 4998.656016961385, 27759.314882585284],
[80501.84240829022, 4998.633241814745, 27759.303165128335],
[80405.59311555464, 4998.610093059483, 27759.291255290755],
[80309.34171230388, 4998.586564962256, 27759.279150118266],
[80213.08819924091, 4998.562651711211, 27759.26684661606],
[80116.83257707927, 4998.538347415111, 27759.25434174837],
[80020.57484654324, 4998.513646102448, 27759.24163243797],
[79924.315008368, 4998.488541720551, 27759.228715565743],
[79828.05306329973, 4998.463028134697, 27759.215587970222],
[79731.78901209579, 4998.4370991272, 27759.202246447083],
[79635.5228555249, 4998.410748396507, 27759.188687748712],
[79539.25459436726, 4998.383969556283, 27759.17490858372],
[79442.98422941467, 4998.356756134487, 27759.160905616445],
[79346.71176147074, 4998.329101572451, 27759.146675466505],
[79250.43719135105, 4998.30099922394, 27759.13221470827],
[79154.16051988328, 4998.27244235422, 27759.11751987042],
[79057.88174790739, 4998.243424139107, 27759.10258743542],
[78961.60087627577, 4998.213937664021, 27759.087413839035],
[78865.3179058534, 4998.1839759230215, 27759.07199546984],
[78769.03283751805, 4998.153531817855, 27759.056328668714],
[78672.74567216044, 4998.122598156978, 27759.040409728324],
[78576.45641068435, 4998.091167654586, 27759.02423489264],
[78480.16505400687, 4998.05923292963, 27759.007800356405],
[78383.87160305855, 4998.026786504834, 27758.99110226464],
[78287.57605878357, 4997.993820805699, 27758.974136712106],
[78191.2784221399, 4997.960328159509, 27758.9568997428],
[78094.97869409951, 4997.926300794322, 27758.939387349423],
[77998.67687564854, 4997.891730837962, 27758.92159547286],
[77902.37296778747, 4997.856610317009, 27758.903520001637],
[77806.06697153131, 4997.820931155768, 27758.88515677142],
[77709.75888790983, 4997.784685175253, 27758.866501564436],
[77613.44871796768, 4997.747864092146, 27758.84755010897],
[77517.13646276463, 4997.710459517766, 27758.82829807881],
[77420.82212337572, 4997.672462957019, 27758.808741092696],
[77324.50570089152, 4997.633865807354, 27758.78887471378],
[77228.18719641824, 4997.594659357705, 27758.768694449074],
[77131.86661107802, 4997.554834787435, 27758.74819574889],
[77035.54394600906, 4997.514383165265, 27758.727374006292],
[76939.21920236584, 4997.473295448209, 27758.706224556536],
[76842.89238131937, 4997.431562480493, 27758.68474267649],
[76746.56348405732, 4997.389174992475, 27758.662923584092],
[76650.23251178428, 4997.346123599559, 27758.640762437768],
[76553.89946572199, 4997.302398801101, 27758.618254335848],
[76457.56434710945, 4997.25799097931, 27758.595394316017],
[76361.22715720326, 4997.21289039815, 27758.572177354716],
[76264.88789727777, 4997.167087202227, 27758.548598366575],
[76168.54656862532, 4997.120571415677, 27758.524652203814],
[76072.2031725564, 4997.073332941049, 27758.500333655673],
[75975.85771039999, 4997.025361558179, 27758.475637447806],
[75879.51018350366, 4996.976646923063, 27758.4505582417],
[75783.1605932339, 4996.9271785667215, 27758.425090634068],
[75686.80894097626, 4996.876945894062, 27758.399229156264],
[75590.45522813567, 4996.825938182735, 27758.37296827367],
[75494.0994561366, 4996.77414458198, 27758.346302385096],
[75397.74162642332, 4996.721554111479, 27758.31922582217],
[75301.38174046014, 4996.668155660193, 27758.29173284874],
[75205.01979973169, 4996.613937985198, 27758.263817660227],
[75108.65580574307, 4996.558889710516, 27758.235474383055],
[75012.28976002017, 4996.502999325941, 27758.206697073994],
[74915.92166410989, 4996.446255185862, 27758.177479719554],
[74819.55151958039, 4996.388645508076, 27758.14781623536],
[74723.17932802135, 4996.3301583726, 27758.117700465522],
[74626.8050910442, 4996.270781720479, 27758.087126182],
[74530.42881028239, 4996.210503352586, 27758.056087083984],
[74434.05048739167, 4996.149310928417, 27758.024576797234],
[74337.67012405029, 4996.087191964888, 27757.992588873458],
[74241.28772195934, 4996.024133835113, 27757.96011678967],
[74144.90328284292, 4995.960123767196, 27757.927153947523],
[74048.5168084485, 4995.8951488429975, 27757.8936936727],
[73952.12830054716, 4995.829195996916, 27757.85972921422],
[73855.7377609338, 4995.762252014648, 27757.825253743795],
[73759.34519142749, 4995.694303531955, 27757.790260355207],
[73662.95059387172, 4995.625337033417, 27757.754742063596],
[73566.55397013466, 4995.55533885119, 27757.718691804825],
[73470.15532210947, 4995.484295163747, 27757.682102434803],
[73373.75465171455, 4995.412191994627, 27757.644966728825],
[73277.35196089388, 4995.339015211167, 27757.6072773809],
[73180.94725161725, 4995.264750523235, 27757.569027003046],
[73084.54052588057, 4995.189383481963, 27757.530208124652],
[72988.13178570615, 4995.112899478461, 27757.49081319177],
[72891.72103314304, 4995.035283742542, 27757.45083456643],
[72795.30827026725, 4994.956521341426, 27757.410264525955],
[72698.89349918216, 4994.876597178455, 27757.36909526228],
[72602.4767220187, 4994.795495991788, 27757.327318881224],
[72506.05794093575, 4994.713202353099, 27757.284927401826],
[72409.63715812036, 4994.629700666271, 27757.24191275563],
[72313.21437578817, 4994.544975166074, 27757.198266785974],
[72216.78959618362, 4994.459009916853, 27757.153981247262],
[72120.36282158032, 4994.371788811194, 27757.109047804297],
[72023.93405428133, 4994.283295568601, 27757.06345803153],
[71927.50329661953, 4994.19351373415, 27757.017203412342],
[71831.07055095791, 4994.102426677153, 27756.970275338317],
[71734.63581968988, 4994.010017589805, 27756.92266510854],
[71638.19910523963, 4993.9162694858305, 27756.874363928833],
[71541.76041006246, 4993.82116519912, 27756.825362911033],
[71445.31973664505, 4993.724687382364, 27756.775653072247],
[71348.8770875059, 4993.6268185056815, 27756.72522533411],
[71252.43246519557, 4993.527540855234, 27756.67407052205],
[71155.98587229708, 4993.426836531845, 27756.622179364505],
[71059.53731142625, 4993.324687449599, 27756.569542492187],
[70963.086785232, 4993.221075334447, 27756.516150437314],
[70866.63429639673, 4993.115981722795, 27756.461993632845],
[70770.17984763671, 4993.009387960093, 27756.407062411716],
[70673.72344170236, 4992.901275199407, 27756.35134700604],
[70577.26508137865, 4992.791624399993, 27756.29483754636],
[70480.80476948545, 4992.68041632586, 27756.23752406084],
[70384.34250887789, 4992.5676315443225, 27756.17939647448],
[70287.87830244674, 4992.453250424546, 27756.120444608314],
[70191.41215311877, 4992.337253136088, 27756.060658178623],
[70094.94406385711, 4992.219619647427, 27756.000026796115],
[69998.47403766162, 4992.100329724481, 27755.938539965122],
[69902.0020775693, 4991.979362929121, 27755.876187082773],
[69805.52818665463, 4991.856698617675, 27755.81295743817],
[69709.05236802998, 4991.732315939418, 27755.74884021157],
[69612.57462484598, 4991.60619383506, 27755.68382447353],
[69516.09496029191, 4991.4783110352155, 27755.617899184075],
[69419.61337759612, 4991.348646058868, 27755.55105319186],
[69323.12988002638, 4991.217177211825, 27755.48327523328],
[69226.64447089029, 4991.083882585158, 27755.414553931652],
[69130.15715353569, 4990.948740053632, 27755.344877796295],
[69033.6679313511, 4990.811727274127, 27755.2742352217],
[68937.17680776604, 4990.672821684049, 27755.202614486607],
[68840.68378625151, 4990.5320004997175, 27755.130003753136],
[68744.18887032037, 4990.389240714756, 27755.056391065886],
[68647.6920635278, 4990.244519098458, 27754.981764351003],
[68551.19336947164, 4990.097812194148, 27754.9061114153],
[68454.69279179291, 4989.94909631752, 27754.82941994529],
[68358.19033417615, 4989.798347554973, 27754.75167750629],
[68261.6860003499, 4989.64554176192, 27754.672871541457],
[68165.17979408712, 4989.490654561095, 27754.592989370834],
[68068.67171920562, 4989.333661340834, 27754.512018190395],
[67972.16177956853, 4989.174537253345, 27754.42994507108],
[67875.64997908469, 4989.013257212963, 27754.346756957788],
[67779.13632170913, 4988.849795894387, 27754.262440668423],
[67682.62081144351, 4988.684127730898, 27754.176982892848],
[67586.10345233663, 4988.51622691256, 27754.090370191912],
[67489.58424848475, 4988.346067384411, 27754.00258899639],
[67393.06320403221, 4988.173622844619, 27753.913625605976],
[67296.5403231718, 4987.998866742635, 27753.82346618821],
[67200.01561014524, 4987.821772277318, 27753.732096777432],
[67103.48906924369, 4987.642312395039, 27753.639503273705],
[67006.96070480817, 4987.460459787769, 27753.545671441727],
[66910.4305212301, 4987.27618689114, 27753.450586909745],
[66813.89852295173, 4987.08946588249, 27753.354235168412],
[66717.36471446666, 4986.900268678877, 27753.25660156969],
[66620.82910032033, 4986.708566935079, 27753.1576713257],
[66524.29168511051, 4986.514332041563, 27753.05742950756],
[66427.7524734878, 4986.317535122431, 27752.95586104421],
[66331.21147015612, 4986.118147033341, 27752.85295072125],
[66234.66867987328, 4985.916138359403, 27752.748683179696],
[66138.1241074514, 4985.711479413042, 27752.643042914806],
[66041.57775775748, 4985.504140231844, 27752.53601427481],
[65945.02963571395, 4985.294090576363, 27752.427581459677],
[65848.47974629913, 4985.0812999279015, 27752.31772851982],
[65751.92809454781, 4984.865737486266, 27752.206439354846],
[65655.37468555175, 4984.647372167485, 27752.093697712204],
[65558.81952446028, 4984.426172601497, 27751.979487185883],
[65462.262616480766, 4984.202107129807, 27751.86379121505],
[65365.70396687921, 4983.975143803108, 27751.74659308271],
[65269.1435809808, 4983.74525037887, 27751.627875914273],
[65172.58146417046, 4983.512394318887, 27751.50762267619],
[65076.0176218934, 4983.276542786799, 27751.385816174472],
[64979.452059655734, 4983.037662645561, 27751.262439053295],
[64882.88478302501, 4982.795720454889, 27751.137473793453],
[64786.3157976308, 4982.550682468656, 27751.01090271092],
[64689.7451091653, 4982.30251463225, 27750.882707955287],
[64593.172723383905, 4982.051182579889, 27750.7528715082],
[64496.59864610581, 4981.796651631902, 27750.62137518183],
[64400.02288321464, 4981.538886791947, 27750.488200617212],
[64303.445440658994, 4981.277852744207, 27750.35332928267],
[64206.866324453134, 4981.0135138505175, 27750.216742472116],
[64110.28554067755, 4980.745834147463, 27750.07842130338],
[64013.70309547961, 4980.474777343416, 27749.938346716495],
[63917.11899507419, 4980.200306815527, 27749.79649947194],
[63820.533245744315, 4979.922385606668, 27749.65286014889],
[63723.94585384179, 4979.6409764223135, 27749.50740914337],
[63627.35682578787, 4979.356041627375, 27749.36012666644],
[63530.76616807391, 4979.067543242977, 27749.210992742323],
[63434.17388726202, 4978.77544294318, 27749.059987206478],
[63337.579989985745, 4978.479702051636, 27748.90708970367],
[63240.98448295075, 4978.180281538196, 27748.752279685992],
[63144.3873729355, 4977.877142015443, 27748.595536410852],
[63047.788666791945, 4977.570243735171, 27748.436838938916],
[62951.188371446246, 4977.259546584801, 27748.27616613201],
[62854.58649389944, 4976.94501008372, 27748.11349665101],
[62757.9830412282, 4976.626593379565, 27747.948808953657],
[62661.37802058553, 4976.304255244425, 27747.782081292346],
[62564.771439201504, 4975.977954070982, 27747.61329171188],
[62468.163304384005, 4975.647647868575, 27747.44241804717],
[62371.553623519474, 4975.313294259187, 27747.26943792088],
[62274.94240407366, 4974.974850473358, 27747.094328741066],
[62178.32965359241, 4974.632273346017, 27746.917067698723],
[62081.71537970239, 4974.28551931224, 27746.7376317653],
[61985.099590111924, 4973.934544402914, 27746.555997690197],
[61888.48229261175, 4973.579304240331, 27746.372141998152],
[61791.86349507583, 4973.219754033682, 27746.186040986624],
[61695.24320546216, 4972.855848574471, 27745.99767072312],
[61598.621431813604, 4972.487542231835, 27745.80700704244],
[61501.99818225869, 4972.1147889477725, 27745.614025543895],
[61405.37346501248, 4971.737542232279, 27745.41870158845],
[61308.7472883774, 4971.35575515838, 27745.22101029583],
[61212.11966074412, 4970.969380357066, 27745.020926541547],
[61115.49059059241, 4970.578370012133, 27744.818424953868],
[61018.860086492015, 4970.182675854907, 27744.613479910742],
[60922.22815710357, 4969.782249158871, 27744.40606553664],
[60825.59481117949, 4969.37704073418, 27744.19615569935],
[60728.96005756489, 4968.967000922061, 27743.983724006666],
[60632.32390519849, 4968.552079589103, 27743.768743803088],
[60535.6863631136, 4968.132226121432, 27743.55118816636],
[60439.047440439026, 4967.707389418758, 27743.331029903995],
[60342.40714640007, 4967.277517888308, 27743.108241549726],
[60245.765490319485, 4966.842559438629, 27742.882795359852],
[60149.12248161846, 4966.402461473268, 27742.654663309535],
[60052.47812981765, 4965.957170884313, 27742.423817089002],
[59955.83244453817, 4965.506634045809, 27742.190228099684],
[59859.185435502644, 4965.050796807028, 27741.953867450262],
[59762.537112536214, 4964.58960448561, 27741.714705952636],
[59665.887485567655, 4964.123001860549, 27741.47271411779],
[59569.236564630395, 4963.650933165041, 27741.227862151612],
[59472.58435986365, 4963.173342079179, 27740.98011995057],
[59375.93088151349, 4962.690171722494, 27740.729457097354],
[59279.27613993398, 4962.201364646339, 27740.475842856373],
[59182.62014558833, 4961.706862826121, 27740.219246169177],
[59085.96290905001, 4961.206607653355, 27739.959635649815],
[58989.304441003966, 4960.700539927561, 27739.696979580025],
[58892.64475224776, 4960.18859984799, 27739.431245904383],
[58795.983853692815, 4959.670727005169, 27739.162402225313],
[58699.32175636561, 4959.146860372272, 27738.89041579801],
[58602.65847140893, 4958.616938296307, 27738.615253525226],
[58505.994010083145, 4958.080898489114, 27738.336881951993],
[58409.328383767446, 4957.538678018177, 27738.055267260166],
[58312.66160396118, 4956.990213297237, 27737.770375262913],
[58215.99368228516, 4956.435440076702, 27737.482171399042],
[58119.32463048298, 4955.874293433867, 27737.190620727233],
[58022.65446042241, 4955.306707762905, 27736.895687920107],
[57925.983184096745, 4954.732616764662, 27736.597337258238],
[57829.31081362623, 4954.1519534362305, 27736.29553262394],
[57732.63736125947, 4953.56465006029, 27735.990237495],
[57635.96283937487, 4952.970638194233, 27735.681414938234],
[57539.28726048213, 4952.369848659057, 27735.369027602912],
[57442.61063722372, 4951.762211528009, 27735.05303771404],
[57345.93298237639, 4951.147656114998, 27734.73340706551],
[57249.25430885274, 4950.526110962754, 27734.41009701305],
[57152.57462970274, 4949.897503830732, 27734.083068467095],
[57055.8939581154, 4949.261761682765, 27733.752281885452],
[56959.21230742029, 4948.618810674441, 27733.4176972658],
[56862.52969108927, 4947.968576140218, 27733.079274138054],
[56765.84612273813, 4947.310982580258, 27732.73697155656],
[56669.161616128265, 4946.645953646977, 27732.390748092086],
[56572.47618516847, 4945.973412131316, 27732.040561823673],
[56475.78984391664, 4945.293279948697, 27731.68637033028],
[56379.10260658159, 4944.605478124699, 27731.328130682283],
[56282.41448752487, 4943.909926780413, 27730.965799432728],
[56185.72550126261, 4943.206545117481, 27730.599332608446],
[56089.03566246741, 4942.495251402822, 27730.228685700946],
[55992.34498597025, 4941.7759629530165, 27729.8538136571],
[55895.65348676245, 4941.048596118367, 27729.474670869655],
[55798.96117999764, 4940.313066266603, 27729.091211167488],
[55702.26808099379, 4939.569287766242, 27728.703387805686],
[55605.57420523526, 4938.817173969589, 27728.31115345538],
[55508.87956837488, 4938.056637195367, 27727.91446019335],
[55412.18418623612, 4937.287588710975, 27727.513259491454],
[55315.488074815185, 4936.509938714356, 27727.107502205734],
[55218.791250283284, 4935.723596315485, 27726.697138565334],
[55122.09372898885, 4934.928469517441, 27726.282118161173],
[55025.39552745983, 4934.124465197079, 27725.86238993435],
[54928.696662405986, 4933.311489085281, 27725.437902164274],
[54831.99715409537, 4899.291951911507, 27725.007635050995],
[54735.297019647136, 4898.464478668342, 27724.572491932842],
[54638.596276369935, 4897.627785654101, 27724.132418908564],
[54541.894941764454, 4896.78177426508, 27723.6873613635],
[54445.193033525946, 4895.926344652128, 27723.23726395628],
[54348.49056954684, 4895.061395698291, 27722.782070605255],
[54251.78756791939, 4894.186824995956, 27722.32172447465],
[54155.084046938384, 4893.302528823515, 27721.85616796031],
[54058.38002510389, 4892.408402121505, 27721.385342675247],
[53961.67552112408, 4891.504338468235, 27720.909189434755],
[53864.97055391806, 4890.590230054878, 27720.427648241253],
[53768.265142618795, 4889.665967660021, 27719.940658268737],
[53671.559306576084, 4888.731440623656, 27719.448157846928],
[53574.85306535959, 4887.786536820604, 27718.95008444501],
[53478.1464387619, 4886.831142633351, 27718.446374655025],
[53381.43944680169, 4885.865142924298, 27717.9369641749],
[53284.73210972694, 4884.888421007394, 27717.421787791034],
[53188.02444801816, 4883.9008586191485, 27716.90077936055],
[53091.31648239176, 4882.902335889008, 27716.37387179308],
[52994.60823380344, 4881.892731309079, 27715.84099703219],
[52897.899723451636, 4880.871921703182, 27715.30208603634],
[52801.19097278108, 4879.839782195231, 27714.75706875938],
[52704.482003486366, 4878.796186176905, 27714.20587413067],
[52607.77283751565, 4877.741005274612, 27713.648430034675],
[52511.0634970744, 4876.674109315719, 27713.08466329011],
[52414.35400462919, 4875.595366294037, 27712.514499628593],
[52317.644382911625, 4874.504642334541, 27711.937863672814],
[52220.93465492231, 4873.401801657302, 27711.35467891421],
[52124.22484393491, 4872.286706540624, 27710.764867690035],
[52027.51497350028, 4871.159217283361, 27710.168351160017],
[51930.80506745068, 4870.019192166387, 27709.56504928237],
[51834.095157050295, 4820.173993358183, 27708.95283325225],
[51737.38526678935, 4819.016247485515, 27708.333644697454],
[51640.675421453714, 4817.845615632801, 27707.707399539155],
[51543.96564612943, 4816.661948640662, 27707.074012391015],
[51447.25596620746, 4815.465095141547, 27706.433396532168],
[51350.54640738844, 4814.25490151606, 27705.785463879598],
[51253.83699568759, 4813.031211848307, 27705.130124959815],
[51157.12775743968, 4811.793867880236, 27704.46728887987],
[51060.41871930414, 4810.542708964953, 27703.7968632977],
[50963.70990827026, 4809.277572018985, 27703.118754391737],
[50867.00135166249, 4807.998291473462, 27702.43286682979],
[50770.29307714586, 4806.704699224197, 27701.739103737193],
[50673.58511273154, 4805.396624580635, 27701.037366664175],
[50576.877486782454, 4804.073894213648, 27700.327555552456],
[50480.17022801909, 4802.736332102135, 27699.609568701],
[50383.46336552537, 4801.383759478421, 27698.883302730977],
[50286.75692875471, 4800.015994772399, 27698.14865254987],
[50190.05094753612, 4798.632853554406, 27697.405511314657],
[50093.345452080524, 4797.234148476794, 27696.65377039416],
[49996.64047298718, 4795.819689214157, 27695.893319330433],
[49899.93604125022, 4794.389282402196, 27695.124045799217],
[49803.23218826537, 4792.942731575177, 27694.345835569395],
[49706.528945836784, 4791.4798371019515, 27693.55857246151],
[49609.82634618404, 4790.000396120503, 27692.76213830516],
[49513.12442194931, 4788.5042024709865, 27691.956412895437],
[49416.42320620464, 4786.991046627217, 27691.141273948226],
[49319.72273245944, 4785.4607156265765, 27690.316597054385],
[49223.023034668106, 4783.912992998297, 27689.482255632814],
[49126.32414723781, 4782.347658690072, 27688.638120882337],
[49029.6261050365, 4780.764488992971, 27687.784061732345],
[48932.92894340104, 4779.163256464593, 27686.91994479226],
[48836.23284489957, 4149.897981420965, 27686.003614796562],
[48739.53784758355, 4148.406746153216, 27685.07645433245],
[48642.843990022935, 4146.898448432607, 27684.138315911787],
[48546.151311315465, 4145.372867729184, 27683.189049387754],
[48449.459851096246, 4143.829779764831, 27682.228501894715],
[48352.769649547525, 4142.26895643371, 27681.256517786573],
[48256.080747408654, 4140.690165720817, 27680.27293857352],
[48159.39318598635, 4139.09317161864, 27679.277602857183],
[48062.70700716512, 4137.477734041839, 27678.270346264097],
[47966.022253417956, 4135.843608739929, 27677.25100137744],
[47869.33908475644, 3756.4421631282166, 27676.18592233707],
[47772.65754628777, 3754.8734072756097, 27675.108005304042],
[47675.97768376163, 3753.286428427577, 27674.01706750396],
[47579.299543582245, 3751.6809816911536, 27672.91292271823],
[47482.62317282081, 3750.056817849083, 27671.79538120385],
[47385.948619228126, 3748.413683266271, 27670.664249611094],
[47289.275931247605, 3746.75131979402, 27669.51933089903],
[47192.60515802852, 3745.069464671982, 27668.360424248847],
[47095.9363494396, 3743.3678504277773, 27667.187324974773],
[46999.269556082945, 3741.646204774215, 27665.999824432736],
[46902.60487415424, 3622.602839855635, 27664.784875022462],
[46805.942356324704, 3620.877350035162, 27663.554935573207],
[46709.28205605106, 3619.131429303955, 27662.309782606717],
[46612.62402759095, 3617.364791503954, 27661.04918824864],
[46515.968326018796, 3615.577145233222, 27659.77292012306],
[46419.31500724195, 3613.768193730285, 27658.48074124415],
[46322.66412801733, 3611.9376347556913, 27657.172409904888],
[46226.01574596837, 3610.0851604707095, 27655.847679562747],
[46129.369919602446, 3608.2104573131005, 27654.50629872223],
[46032.72670832871, 3606.3132058698834, 27653.148010814228],
[45936.086172476316, 3604.3930807470183, 27651.772554072002],
[45839.44840847391, 3525.487689205068, 27650.36960085957],
[45742.813478999444, 3523.5489345988913, 27648.948810471746],
[45646.18144771557, 3521.586641768043, 27647.50990273753],
[45549.55237928992, 3519.6004653247383, 27646.05259171501],
[45452.92633941586, 3517.5900533045738, 27644.57658554811],
[45356.303394833834, 3515.555047018484, 27643.08158631932],
[45259.683613353154, 3513.49508090108, 27641.567289898263],
[45163.0670638744, 3511.4097823552893, 27640.033385786028],
[45066.4546594419, 2276.0590612052392, 27638.23838331365],
[44969.8464823353, 2274.4578673437513, 27636.419965167075],
[44873.242616179006, 2272.836969512069, 27634.577748708507],
[44776.643145970826, 2271.196072008378, 27632.711343151204],
[44680.04815811132, 2269.53487343502, 27630.82034935197],
[44583.45926557541, 1225.3182268258647, 27628.46809565507],
[44486.876578192256, 1224.1888056512294, 27626.084585331977],
[44390.30020763321, 1223.0454821296332, 27623.669294187253],
[44293.730267451894, 1221.8880477805783, 27621.221686622765],
[44197.166873125294, 1220.716290161394, 27618.74121534244],
[44100.61014209593, 1219.529992781702, 27616.227321048416],
[44004.06019381514, 1218.3289350159953, 27613.679432128272],
[43907.517149787454, 1217.11289201429, 27611.096964333046],
[43810.982840660356, 727.7379505331625, 27607.991109595154],
[43714.457415931596, 726.8526267347654, 27604.842708486154],
[43617.94102771106, 725.9563276042863, 27601.65101769915],
[43521.43383077946, 725.0488874251863, 27598.415277213757],
[43424.93598264866, 724.1301373780938, 27595.134709851718],
[43328.449812902545, 432.83257147206206, 27591.188180080033],
[43231.97551561068, 432.1637511262883, 27587.186418199995],
[43135.5132883249, 431.4866838189466, 27583.128433260044],
[43039.06399071421, 376.6522720526424, 27578.82489945261],
[42942.62783706502, 376.0178092019613, 27574.46037976885],
[42846.2064645212, 288.4834006433379, 27569.628034946414],
[42749.80011601653, 287.9378799572551, 27564.726550596042],
[42653.4090389606, 287.3856705993897, 27559.754652997726],
[42557.038903231485, 128.329752201512, 27553.161977583623],
[42460.69004633578, 127.99884749022866, 27546.473243696797],
[42364.36281211962, 127.6640512966753, 27539.68664716557],
[42268.05755091941, 127.32531129666029, 27532.80034092078],
[42171.77461971672, 126.98257441900974, 27525.812433804644],
[42075.51438229753, 126.63578683965714, 27518.72098934255],
[41979.277209415864, 126.28489397604908, 27511.524024476534],
[41883.06582067072, 96.76972004843606, 27503.55007906339],
[41786.880637600414, 96.46835560036101, 27495.456158153873],
[41690.72208995179, 96.16348283944833, 27487.23992561743],
[41594.59061588094, 95.85505649660273, 27478.898988202167],
[41498.48666215956, 95.54303075636388, 27470.4308939128],
[41402.41068438726, 95.22735925811057, 27461.833130337076],
[41306.36314720988, 94.90799509785191, 27453.10312291907],
[41210.34452454411, 94.58489083064384, 27444.23823317736],
[41114.35529980856, 94.25799847367091, 27435.235756866263],
[41018.39596616147, 93.92726951003567, 27426.092922078104],
[40922.467026745355, 93.59265489329988, 27416.806887284456],
[40826.568994938694, 93.2541050528239, 27407.374739314233],
[40730.702394615015, 92.91156989995311, 27397.793491266413],
[40634.86776040951, 92.56499883510232, 27388.06008035509],
[40539.065637993466, 92.214340755792, 27378.171365684502],
[40443.29658435683, 91.85954406569228, 27368.124125951454],
[40347.56116809901, 91.50055668473364, 27357.915057072794],
[40251.85996972839, 91.13732606034586, 27347.540769735017],
[40156.19358197066, 90.76979917988982, 27336.997786863452],
[40060.56261008638, 90.39792258434949, 27326.282541008073],
[39964.967672198, 90.02164238335477, 27315.391371642967],
[39869.40939962672, 89.64090427160892, 27304.320522376438],
[39773.888437239446, 89.25565354679767, 27293.066138068505],
[39678.40544380624, 88.86583512906046, 27281.624261852525],
[39582.96109236856, 88.47139358210794, 27269.990832057465],
[39487.556070618695, 88.07227313607335, 27258.16167902733],
[39392.191081290744, 87.6684177121892, 27246.13252183399],
[39296.86684256353, 87.25977094938449, 27233.898964879656],
[39201.58408847588, 86.84627623290194, 27221.45649438494],
[39106.343569354605, 86.42787672503827, 27208.800474758496],
[39011.14605225575, 86.00451539811525, 27195.92614484393],
[38915.99232141943, 85.57613506979315, 27182.8286140395],
[38820.88317873874, 85.14267844084283, 27169.50285828617],
[38725.81944424332, 84.70408813549692, 27155.94371591912],
[38630.801956597934, 84.26030674450531, 27142.14588337791],
[38535.83157361664, 83.81127687102453, 27128.103910770125],
[38440.90917279314, 83.35694117947534, 27113.81219728325],
[38346.03565184773, 82.89724244750765, 27099.264986439324],
[38251.21192929156, 82.4321236212164, 27084.456361186665],
[38156.43894500871, 81.96152787375698, 27069.38023882286],
[38061.71766085673, 81.4853986675133, 27054.03036574289],
[37967.04906128627, 81.0036798199766, 27038.400312006135],
[37872.46934874376, 18.448126096535912, 27012.431451597437],
[37777.98025398352, 18.263950044474743, 26985.969958845493],
[37683.58354968868, 18.07832550379323, 26959.003899664018],
[37589.28105166865, 17.891260870019117, 26931.520999157958],
[37495.074620093845, 17.702765680760585, 26903.508631031567],
[37400.96616076869, 17.512850664824995, 26874.953806668876],
[37306.95762644426, 17.321527792493104, 26845.84316387861],
[37213.05101817166, 17.12881032691368, 26816.162955295807],
[37119.24838669738, 16.934712876576306, 26785.899036432478],
[37025.5518339019, 16.73925144881221, 26755.03685336982],
[36931.963514282885, 16.54244350426463, 26723.561430084963],
[36838.48563648413, 16.344308012261035, 26691.457355405186],
[36745.12046487182, 16.144865507009825, 26658.7087695833],
[36651.87032115917, 15.944138144533442, 26625.29935048811],
[36558.73758608112, 15.742149760238746, 26591.21229940453],
[36465.72470112021, 15.538925927013327, 26556.4303264386],
[36372.83417028522, 15.334494013723639, 26520.93563552328],
[36280.068561943874, 15.128883243977155, 26484.70990902203],
[36187.43051071114, 14.922124754996277, 26447.734291927893],
[36094.92271939445, 14.714251656436307, 26409.989375657216],
[36002.54796099731, 14.50529908896362, 26371.455181438403],
[35910.30908078271, 14.295304282393133, 26332.111143297505],
[35818.20899839777, 14.08430661316608, 26291.93609064436],
[35726.25071006095, 13.872347660930473, 26250.908230464785],
[35634.43729081325, 13.659471263966855, 26209.005129126566],
[35542.77189683463, 13.44572357318163, 26166.20369380956],
[35451.25776782706, 13.231153104368918, 26122.480153572735],
[35359.89822946528, 13.01581078842015, 26077.810040074408],
[35268.69669591653, 12.799750019137917, 26032.168167965105],
[35177.65667243025, 12.583026698287497, 25985.528614976545],
[35086.78175799879, 12.365699277496049, 25937.864701734445],
[34996.075648089936, 12.147828796585342, 25889.148971327668],
[34905.542137451965, 11.929478917900019, 25839.35316867156],
[34815.18512299188, 11.71071595616905, 25788.44821970925],
[34725.00860672716, 11.491608903414267, 25736.404210501198],
[34635.016698811225, 11.272229448396107, 25683.190366260445],
[34545.21362063258, 11.052651990063874, 25628.775030399214],
[34455.6037079874, 10.832953644455682, 25573.125643661042],
[34366.19141432487, 10.613214244472482, 25516.208723422606],
[34276.981314064455, 10.393516331931213, 25457.98984325984],
[34187.97810598368, 10.173945141284902, 25398.433612884965],
[34099.18661667489, 9.954588574382461, 25337.503658573605],
[34010.61180406858, 9.735537165628907, 25275.162604215635],
[33922.258761020814, 9.51688403689781, 25211.372053138544],
[33834.132718961235, 9.298724841542892, 25146.092570869238],
[33746.23905159792, 9.081157696855085, 25079.283669018463],
[33658.5832786743, 8.864283104315946, 25010.903790492186],
[33571.171069772725, 8.6482038570084, 24940.910296256054],
[33484.00824815842, 8.4330249335624, 24869.25945390279],
[33397.100794656406, 8.21885337803655, 24795.906428297978],
[33310.454851553215, 8.005798165168171, 24720.80527460755],
[33224.07672651369, 7.793970050463966, 24643.908934040006],
[33137.97289650219, 7.583481404652565, 24565.169232668934],
[33052.15001169596, 7.374446032079047, 24484.53688373549],
[32966.614899376844, 7.1669789726911635, 24401.961493867962],
[32881.37456778609, 6.961196287347731, 24317.39157369452],
[32796.43620992483, 6.757214826272356, 24230.77455336743],
[32711.807207281123, 6.55515198058065, 24142.056803561198],
[32627.49513346222, 6.355125416926996, 24051.183662553798],
[32543.507757708354, 6.157252795447701, 23958.099470049074],
[32459.853048261906, 5.961651471321635, 23862.74760844942],
[32376.53917556314, 5.768438180426644, 23765.070552340443],
[32293.574515240813, 5.577728709740288, 23665.00992700353],
[32210.967650862905, 5.389637553316064, 23562.5065768272],
[32128.727376409475, 5.204277554860517, 23457.500644543394],
[32046.862698426183, 5.021759538141502, 23349.931662269675],
[31965.382837813435, 4.842191926671735, 23239.738655391575],
[31884.297231202225, 4.665680354333018, 23126.860260370042],
[31803.61553186383, 4.492327268832914, 23011.234857605577],
[31723.34761009637, 4.322231530114505, 22892.800720531708],
[31643.503553027025, 4.155488006068169, 22771.496182143845],
[31564.093663764368, 3.9921871681186456, 22647.25982019308],
[31485.128459830903, 3.8324146894770306, 22520.03066228572],
[31406.6186708016, 3.676251049051461, 22389.74841212511],
[31328.57523506987, 3.523771144197359, 22256.353698109368],
[31251.009295658452, 3.375043915653336, 22119.788345453606],
[31173.93219498863, 3.2301319881465913, 21979.99567293337],
[31097.35546851793, 3.0890913302567946, 21836.92081524384],
[31021.290837153254, 2.9519709371941363, 21690.511071831177],
[30945.7501983441, 2.8188125401701805, 21540.716282874146],
[30870.74561575892, 2.6896503460140733, 21387.489232869968],
[30796.28930744699, 2.564510810606622, 21230.7860820037],
[30722.39363238876, 2.44341244956656, 21070.56682514985],
[30649.071075339438, 2.3263656894233913, 20906.795777964115],
[30576.334229874177, 2.2133727622471215, 20739.442089068016],
[30504.195779548467, 2.104427646375543, 20568.480276806415],
[30432.668477094783, 1.9995160554848226, 20393.89078846636],
[30361.765121586242, 1.8986154777904787, 20215.660579184703],
[30291.49853351034, 1.8016952666470953, 20033.783707044127],
[30221.881527710822, 1.70871678324158, 19848.261940067427],
[30152.926884173812, 1.6196335914537752, 19659.105369976045],
[30084.647316655442, 1.534391704299148, 19466.3330266931],
[30017.055439172535, 1.4529298806822044, 19269.973486658982],
[29950.163730405424, 1.3751799704892407, 19070.065467110173],
[29883.98449609276, 1.3010673053494672, 18866.65839757367],
[29818.52982953177, 1.2305111317100283, 18659.81295898106],
[29753.81157033386, 1.1634250822194654, 18449.601580041963],
[29689.841261624024, 1.0997176808123037, 18236.108879874624],
[29626.63010591289, 1.0392928763511498, 18019.432045414233],
[29564.18891991142, 0.9820505992273607, 17799.68113184959],
[29502.52808859968, 0.927887334961009, 17576.979274320132],
[29441.657518901393, 0.8766967085872722, 17351.46279937924],
[29381.58659335428, 0.8283700734786968, 17123.281225332914],
[29322.32412420111, 0.7827970982368642, 16892.597141525],
[29263.87830835644, 0.739866345395207, 16659.58595798005],
[29206.256683728352, 0.6994658359055461, 16424.435518539016],
[29149.466087391047, 0.661483593728989, 16187.345572721637],
[29093.512616112526, 0.6258081653079307, 15948.527103995159],
[29038.401589740028, 0.5923291092473476, 15708.201514876206],
[28984.137517934, 0.5609374521646117, 15466.599672275415],
[28930.724070718457, 0.5315261073594945, 15223.960819629927],
[28878.16405328146, 0.5039902536899787, 14980.531365557725],
[28826.459385414273, 0.4782276727941756, 14736.56356189908],
[28775.61108592236, 0.4541390435532619, 14492.314086966055],
[28725.61926227643, 0.431628193424934, 14248.042552481915],
[28676.483105699044, 0.41060230697302186, 14004.009954944939],
[28628.20089180342, 0.39097209256055127, 13760.477093894084],
[28580.76998681808, 0.37265190874736975, 13517.702980704911],
[28534.18685934635, 0.355559852429374, 13275.943262044675],
[28488.447097525634, 0.3396178111676333, 13035.448681935331],
[28443.545431370258, 0.32475148247895, 12796.463605513485],
[28399.47576000603, 0.31089036309446927, 12559.224626068024],
[28356.231183436095, 0.2979677113426324, 12323.959274840896],
[28313.80403841843, 0.2859204858823349, 12090.884850480057],
[28272.18593798645, 0.27468926400890115, 11860.207382043282],
[28231.36781410684, 0.2642181426882124, 11632.120736187555],
[28191.33996294333, 0.2544546253527527, 11406.805875768694],
[28152.09209218169, 0.24534949732767009, 11184.430273646378],
[28113.61336986965, 0.23685669255533556, 10965.147482160719],
[28075.892474234566, 0.2289331540631013, 10749.096855624664],
[28038.917643961024, 0.2215386903800507, 10536.403420351318],
[28002.676728438248, 0.21463582986260335, 10327.177884275954],
[27967.15723752228, 0.20818967464290203, 10121.516776186352],
[27932.34639039853, 0.20216775567381623, 9919.502702967802],
[27898.23116317507, 0.19653989011483025, 9721.20471210593],
[27864.79833488433, 0.19127804208759536, 9526.67874595851],
[27832.03453161934, 0.18635618763103287, 9335.968173978692],
[27799.926268579136, 0.1817501845051557, 9149.104389106795],
[27768.45998984488, 0.1774376473310163, 8966.107454898696],
[27737.622105753457, 0.17339782841149465, 8786.986790572608],
[27707.39902777726, 0.1696115044535928, 8611.741881979442],
[27677.777200857636, 0.16606086930666, 8440.363007481066],
[27648.743133174245, 0.16272943274140556, 8272.831968805938],
[27620.28342336355, 0.15960192522032868, 8109.122818097046],
[27592.38478522629, 0.15666420854986104, 7949.202573533147],
[27565.034069986566, 0.15390319225658386, 7793.031917057053],
[27538.218286183957, 0.15130675549286632, 7640.565868857117],
[27511.924617295248, 0.14886367424974084, 7491.754434298602],
[27486.140437193946, 0.14656355363543397, 7346.543219975126],
[27460.85332356448, 0.14439676496545717, 7204.874016436468],
[27436.05106939369, 0.14235438740338952, 7066.6853459418835],
[27411.72169266565, 0.14042815388943541, 6931.912974285846],
[27387.853444387052, 0.13861040109560918, 6800.490386346705],
[27364.43481506981, 0.13689402315119487, 6672.349225521754],
[27341.454539795566, 0.13527242888927316, 6547.419697639564],
[27318.901601983376, 0.1337395023740149, 6425.630940288929],
[27296.765235977695, 0.13228956647862083, 6306.911358780228],
[27275.034928568704, 0.1309173492948305, 6191.188930167223],
[27253.700419551536, 0.12961795316649255, 6078.3914769127805],
[27232.75170142498, 0.12838682615150754, 5968.446911888185],
[27212.179018324114, 0.12721973572830636, 5861.283456459701],
[27191.972864275085, 0.12611274457473529, 5756.829833444508],
[27172.12398085399, 0.12506218825865276, 5655.015436717035],
[27152.623354325617, 0.12406465469060071, 5555.770479221648],
[27133.462212331906, 0.12311696519952275, 5459.02612110343],
[27114.632020194054, 0.12221615710261448, 5364.714579609759],
[27096.12447688675, 0.12135946764997345, 5272.769222345133],
[27077.931510737686, 0.12054431923375515, 5183.124645383633],
[27060.04527490052, 0.1197683057600288, 5095.716737659915],
[27042.458142644795, 0.11902918008947047, 5010.482732973319],
[27025.16270250192, 0.1183248424604406, 4927.36125085196],
[27008.151753302256, 0.11765332981488637, 4846.29232743655],
[26991.418299134628, 0.11701280595390708, 4767.217437457816],
[26974.955544255998, 0.11640155245574621, 4690.079508298132],
[26958.756887975967, 0.11581796029445159, 4614.822927047766],
[26942.815919537752, 0.11526052210250125, 4541.393541389559],
[26927.126413014663, 0.11472782502535331, 4469.7386550732535],
[26911.68232223863, 0.11421854412016856, 4399.807018672286],
[26896.4777757752, 0.11373143625490076, 4331.54881625171],
[26881.50707195732, 0.11326533446757513, 4264.915648516089],
[26866.7646739885, 0.1128191427489048, 4199.860512950644],
[26852.245205124316, 0.11239183121444918, 4136.337781417502],
[26837.94344393975, 0.11198243163531958, 4074.303175621483],
[26823.85431968849, 0.1115900332990045, 4013.713740816307],
[26809.972907759337, 0.11121377917423976, 3954.527818082163],
[26796.294425233602, 0.1108528623560033, 3896.705015469102],
[26782.814226546634, 0.11050652276868803, 3840.2061782674887],
[26769.52779925573, 0.11017404410731235, 3784.993358636489],
[26756.430759915962, 0.10985475099828297, 3731.0297847941815],
[26743.51885006487, 0.10954800636273807, 3678.2798299480664],
[26730.787932316365, 0.10925320896688563, 3626.7089811223223],
[26718.233986563777, 0.10896979114502074, 3576.2838080179968],
[26705.853106291463, 0.10869721668206714, 3526.971932024145],
[26693.641494994183, 0.10843497884355259, 3478.7419954816273],
[26681.595462702975, 0.10818259854190136, 3431.5636312867045],
[26669.71142261615, 0.10793962262881948, 3385.4074329084974],
[26657.98588783371, 0.10770562230436571, 3340.244924882756],
[26646.41546819334, 0.10748019163404994, 3296.048533834023],
[26634.996867205988, 0.10726294616598696, 3252.7915600690685],
[26623.726879088925, 0.10705352164076284, 3210.4481497763354],
[26612.60238589403, 0.1068515727872476, 3168.9932678589157],
[26601.620354729046, 0.10665677219811727, 3128.402671422238],
[26590.777835069428, 0.10646880927933366, 3088.652883932049],
[26580.07195615843, 0.10628738926827573, 3049.7211700533962],
[26569.499924492997, 0.10611223231562512, 3011.5855111770193],
[26559.05902139306, 0.1059430726264846, 2974.2245816358613]
])
new_t_list = []
new_d_list = []
for ii in range(len(new_plots)):
	dens = getAtmDensity(lat, lon, new_plots[ii, 0], jd)
	t = luminousEfficiency(3, 1, new_plots[ii, 2], new_plots[ii, 1])
	dyn = dens*vo[ii]**2

	new_t_list.append(t)
	new_d_list.append(dyn)
	print(new_plots[ii, 0], dyn)


plt.plot(tau_list[:, 0]/1000, tau_list[:, 1]/(0.344)*5, label="Single-Body (5.0% at 15 km/s)")
plt.plot(tau_list[:, 0]/1000, tau_list[:, 1]/(0.344)*2.2, label="Single-Body (2.2% at 15 km/s)")
plt.plot(np.array(ho)/1000, np.array(to_list)*100/(0.316)*5, label="Old Model Version (5.0% at 15 km/s)")
plt.plot(np.array(ho)/1000, np.array(to_list)*100/(0.316)*2.2, label="Old Model Version (2.2% at 15 km/s)")
plt.plot(new_plots[:, 0]/1000, np.array(new_t_list)*100/(0.0996)*5, label="New Model (5.0% at 15 km/s)")
plt.plot(new_plots[:, 0]/1000, np.array(new_t_list)*100/(0.0996)*2.2, label="New Model (2.2% at 15 km/s)")
np.set_printoptions(threshold=np.inf)
plt.ylabel("Tau")
plt.xlabel("Height (km)")
plt.ylim([0, 10])
plt.legend()
plt.show()


plt.semilogx(tau_list[:, 4]/1e6, tau_list[:, 2]/1000, label="Single-Body Version")
plt.semilogx(np.array(dyn_list)/1e6, np.array(vo)/1000, label="Old Model Version")
plt.semilogx(np.array(new_d_list)/1e6, new_plots[:, 2]/1000, label="New Model")
plt.ylabel("Velocity (km/s)")
plt.xlabel("Dynamic Pressure [MPa]")
plt.legend()
plt.show()

plt.loglog(tau_list[:, 4]/1e6, tau_list[:, 3], label="Single-Body Version")
plt.scatter(data[:, 0], data[:, 1], label="Borovicka")
plt.loglog(np.array(dyn_list)/1e6, mo, label="Old Model Version")
plt.loglog(np.array(new_d_list)/1e6, new_plots[:, 1], label="New Model")
plt.ylabel("Mass (kg)")
plt.xlabel("Dynamic Pressure [MPa]")
# plt.axvline(x=0.001210611966830714*27671.399566820037**2/1e6)
# plt.axvline(x=0.0026551012397727173*27542.767176247682**2/1e6)
plt.legend()
plt.show()
# luminousEfficiency(3, lum_eff, vel, mass)
# Arguments:
#         lum_eff_type: [int] Lum. eff. model: 
#             0 - constant, 
#             1 - Revelle & Ceplecha (2001): a) Type I, 
#             2 - b) Type II, 
#             3 - c) Type III, 
#             4 - Borovicka et al. (2013) Kosice
#             5 - CAMO faint meteors
#             6 - Celpecha & McCrosky (1976)
#             7 - Borovicka et al. (2020) - Two strengths
#         lum_eff: [double] Value of the constant luminous efficiency (percent).
#         vel: [double] Velocity (m/s).
#         mass: [double] Mass (kg).
#     Return:
#         tau: [double] Luminous efficiency (ratio).



