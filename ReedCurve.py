import numpy as np
import matplotlib.pyplot as plt

W_0 = 4.2e12
k = 2e-4
J_m = 0.375
T_0 = 300
b = 1.19e-4
c_0 = 347
P_0 = 100000
theta = np.pi/2
R = 70000
W_45 = 3.78E6

P = np.array([6598.62,     4833.75,   3551.96,   3047.91,   2617.0798, 1065.95,  919.374, 597.6466])
z = np.array([19000     ,  21000    , 23000    , 24000    , 25000    , 31000    , 32000    ,35000     ])
f = np.array([28.18260  , 35.46615 ,  45.662014, 51.97558 , 59.188779, 146.317  ,174.55479, 296.56677 ])
T = np.array([294.357015, 293.27400,  293.17895, 290.83425, 290.83425, 290.02935, 296.6276 ,303.474493])

# P = np.array([919.374])
# z = np.array([32000])
# f = np.array([174.55479])
# T = np.array([296.6276])
c = 20.05*np.sqrt(T)
# C = k*W_0**(2/3)/4/J_m/T_0

# E = np.exp(-2/3*b*z)

# F = C*E*T*(-f)
# F = k*f/4/J_m**2*(W_0*P/P_0)**(2/3)*(c/c_0)**2
# plt.semilogy(z, -(0.9*W_0)**(-2/3)*F)

# reed_z = np.array([9.576271186440678, 19.74576271186441, 29.661016949152547, 39.83050847457627])*1000
# reed_F = np.array([0.002510676845891704, 0.00484900040683892, 0.008783566346414874, 0.016285862742097586])

# print(np.polyfit(reed_z, np.log(reed_F), 1))
# WF = np.exp(6.16185303e-05*z  -6.56431563e+00)
# # F = (3.78E6**(2/3))*np.exp(6.16185303e-05*z  -6.56431563e+00)

# # E = np.exp(b*z)/P/b#/np.sin(theta)
# # E_2 = -(z**2)**(1/2)/np.log(P/P_0)*(1/P - 1/P_0)

# # F = k*E/4/J_m**2*(W_0*P/P_0)**(2/3)*(c/c_0)**2*(W_0*0.9)**(-2/3)
# # F_2 = k*E_2/4/J_m**2*(W_0*P/P_0)**(2/3)*(c/c_0)**2*(W_0*0.9)**(-2/3)*81

# plt.semilogy(z, WF)
# # plt.semilogy(z, F)
# # plt.semilogy(z, F_2)
# # plt.show()
# # print((np.log(0.28/45)/-F)**(-3/2))


# # W = (-np.log(0.28/45)/WF)**(-3/2)*3.76e6
# # print(W)
# # for i in range(len(W)):
# # 	print("{:.2E}".format((W)[i]))
# # W = (k*f/WF)**(3/2)/8/J_m**3*(P/P_0)*(c/c_0)**(3)*3.78E6
# # W = np.exp(1.5*(6.16185303e-05*z  -6.56431563e+00))*np.log(45/0.28)**(-3/2)*3.78E6
# # W = (k*f/np.exp(6.16185303e-05*z  -6.56431563e+00))**(-3/2)*3.78E6
# alpha = 6.1619e-5
# beta = 6.5643
# W_45 = 3.78E6

# f = 17.554

# dp = (k*f*0.88**2)
# dp2 = k*14.6*1.47**2
# plt.semilogy([32400, 30100], [dp, dp2])
# plt.show()
# print(a)
dp = 0.362
R = 89200
# W = (k*f)**(3/2)/8/J_m**3*W_0*P/P_0*(c/c_0)**(3)*(-np.log(0.05/45) - np.log(P/P_0) + (W_45/W_0)**(2/3)*np.exp(6.16185303e-05*z  -6.56431563e+00))**(3/2)
W = (k*f)**(3/2)/8/J_m**3*W_0*P/P_0*c**3/c_0**3*((W_45/W_0)**(2/3)*np.exp(6.16185303e-05*z  -6.56431563e+00) - np.log(dp*R**1.079*1e-7*(P_0/P)))**(-3/2)
print(W)